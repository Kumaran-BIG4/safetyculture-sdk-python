#Exporter tools

Allows you to export audit reports from the SafetyCulture Platform and save them anywhere on your drive.

Export formats supported: pdf, docx, json

Apply export profiles to your exports by modifying the configuration file (see examples below).

**Instructions**:
  - Follow the instructions in the top-level ReadMe.md
  - Execute the following command from the command line (from within this directory):

    ``pip install -r requirements.txt``
  - Edit config.yaml to customize export settings as shown below


## How to run

To run the export, either double-click exporter.py or execute `python exporter.py` from the command line.

### Common usage

To export all audit reports owned by your SafetyCulture account including those shared with you by other SafetyCulture users run:

```
python exporter.py --formats pdf json docx
```

NB: Up to a 1000 audits will be exported at each run of the tool. To export more than 1000 audits keep running the tool until no audits are returned (see Setting the export start date section below).

## Setting the export start date

Once you have successfully used this tool to extract audit reports, the next time you run it it will only export reports newer than the last time it ran. To reset the export start date edit or delete the file last_successful.txt generated by the exporter tool in this directory. The time is UTC in ISO 8061 format (example: 2016-10-20T05:19:18.352Z).


### Advanced usage

You may want to maintain multiple export configurations in differnt YAML configuration files. To use a specific configuration file (other than config.yaml) do

```
python exporter.py --config=alternate_config.yaml
```

Arguments can be combined e.g. - `python exporter.py --config=alternate_config.yaml --formats pdf json docx`


## Automatic sync

Set the application to run on a recurring schedule with Task Scheduler or cron to keep up to date with all of your audit reports.


## Export settings

To override default export settings edit config.yaml in this directory.

Things you can configure:

*export_path*:     absolute or relative path to export directory

*timezone*   :     must be a valid Olson timezone, if invalid or missing, will default to local timezone

*filename*   :     must be a valid item_id of a header item with a 'text' response.  Currently supported fields are Audit Title, Document No., Client / Site, Prepared By, Personnel, or any custom header item which has a 'text' type response

*export_profiles*: For every template which should have an export profile applied, an export profile id must be supplied
                   This id can be obtained via the Public API.

Note: Templates for which there is no export profile id listed will be exported without a profile applied

Here is an example customised config.yaml:

```
export_options:
    export_path: /Users/Monty/Dropbox
    timezone: America/Chicago
    filename: f3245d40-ea77-11e1-aff1-0800200c9a66
export_profiles:
    template_3E631E46F466411B9C09AD804886A8B4:E15A6525-EFA5-4835-92F0-D11CA9F364F3
    template_3E631E46F466411B9C09AD804886A8B4:E50645A1-2851-4E92-B4EA-60C5CE7981BE
    ...
    ...
```
